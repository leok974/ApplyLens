{
  "id": null,
  "uid": "applylens-phase4-overview",
  "title": "ApplyLens Phase 4 Overview",
  "tags": ["applylens", "demo", "phase4"],
  "timezone": "browser",
  "schemaVersion": 38,
  "version": 1,
  "refresh": "30s",
  "time": { "from": "now-90d", "to": "now" },
  "templating": {
    "list": [
      {
        "name": "api_base",
        "type": "textbox",
        "label": "API Base",
        "query": "http://applylens-api-prod:8003",
        "current": { "text": "http://applylens-api-prod:8003", "value": "http://applylens-api-prod:8003" },
        "options": []
      }
    ]
  },
  "panels": [
    {
      "type": "timeseries",
      "title": "Activity by Day (Messages)",
      "gridPos": { "x": 0, "y": 0, "w": 12, "h": 8 },
      "datasource": { "type": "marcusolsson-json-datasource", "uid": "ApplyLens API" },
      "targets": [
        {
          "refId": "A",
          "url": "${api_base}/api/metrics/profile/activity_daily",
          "method": "GET",
          "format": "json",
          "cacheDurationSeconds": 30,
          "headers": [],
          "jsonPath": "$.rows[*]",
          "fields": [
            {
              "jsonPath": "$.day",
              "name": "time",
              "type": "time"
            },
            {
              "jsonPath": "$.messages_count",
              "name": "Messages",
              "type": "number"
            }
          ]
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "bars", "fillOpacity": 80 },
          "unit": "none",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Unique Senders by Day",
      "gridPos": { "x": 12, "y": 0, "w": 12, "h": 8 },
      "datasource": { "type": "marcusolsson-json-datasource", "uid": "ApplyLens API" },
      "targets": [
        {
          "refId": "A",
          "url": "${api_base}/api/metrics/profile/activity_daily",
          "method": "GET",
          "format": "json",
          "cacheDurationSeconds": 30,
          "headers": [],
          "jsonPath": "$.rows[*]",
          "fields": [
            {
              "jsonPath": "$.day",
              "name": "time",
              "type": "time"
            },
            {
              "jsonPath": "$.unique_senders",
              "name": "Senders",
              "type": "number"
            }
          ]
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "fillOpacity": 10 },
          "unit": "none",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "table",
      "title": "Top Senders (30 Days)",
      "gridPos": { "x": 0, "y": 8, "w": 12, "h": 8 },
      "datasource": { "type": "marcusolsson-json-datasource", "uid": "ApplyLens API" },
      "targets": [
        {
          "refId": "A",
          "url": "${api_base}/api/metrics/profile/top_senders_30d",
          "method": "GET",
          "format": "json",
          "cacheDurationSeconds": 60,
          "headers": [],
          "jsonPath": "$.rows[*]"
        }
      ],
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "message_count" },
            "properties": [
              { "id": "displayName", "value": "Messages" }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "sender" },
            "properties": [
              { "id": "displayName", "value": "Sender" }
            ]
          }
        ]
      }
    },
    {
      "type": "barchart",
      "title": "Categories (30 Days)",
      "gridPos": { "x": 12, "y": 8, "w": 12, "h": 8 },
      "datasource": { "type": "marcusolsson-json-datasource", "uid": "ApplyLens API" },
      "targets": [
        {
          "refId": "A",
          "url": "${api_base}/api/metrics/profile/categories_30d",
          "method": "GET",
          "format": "json",
          "cacheDurationSeconds": 60,
          "headers": [],
          "jsonPath": "$.rows[*]",
          "fields": [
            {
              "jsonPath": "$.category",
              "name": "Category",
              "type": "string"
            },
            {
              "jsonPath": "$.message_count",
              "name": "Messages",
              "type": "number"
            }
          ]
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none",
          "color": { "mode": "palette-classic" }
        }
      },
      "options": {
        "orientation": "horizontal",
        "showValue": "always"
      }
    }
  ]
}
